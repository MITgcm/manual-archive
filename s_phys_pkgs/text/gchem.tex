\section {GCHEM Package} 
\label{sec:pkg:gchem}
\begin{rawhtml}
<!-- CMIREDIR:package_gchem: -->
\end{rawhtml}

\subsection {Introduction}
This package has been developed as interface to the PTRACERS package.
The purpose is to provide a structure where various (any)
tracer experiments can be added to the code.
For instance there are placeholders for routines
to read in parameters needed for any tracer experiments, a routine
to read in extra fields required for the tracer code, routines
for either external forcing or internal interactions between tracers
and routines for additional diagnostics relating to the tracers.
Note that the gchem package itself is only a means to call
the subroutines used by specific biogeochemical experiments,
and does not "do" anything on its own.

There are two examples: cfc which looks at 2 tracers with a
simple external forcing and dic with 5 tracers whose tendency terms
are related to one another. We will discuss these here only as
how they provide examples to use this package.


\subsection {Key subroutines and parameters}

\noindent
{{\bf FRAMEWORK}} \\
{\it GCHEM\_OPTIONS.h} includes the compiler options to be used
in any experiment. For instance \#define ALLOW\_CFC allows
the CFC code to be run. An important compiler option is
 \#define PTRACERS\_SEPARATE\_FORCING which determined 
how and when the tracer forcing is applied (see discussion
on Forcing below).
 There are further runtime parameters
set in {\it data.gchem} and kept in common block {\it GCHEM.h}.
These runtime options include:\\
$\bullet$ {\bf tIter0} which is the integer timestep when the tracer experiment
 is initialized. If {\bf nIter0} $=$ {\bf tIter0} then the tracers
 are initialized to zero or from initial files. If {\bf nIter0} $>$
 {\bf tIter0} then tracers (and previous timestep tendency terms)
  are read in from a the ptracers pickup file. Note that tracers
  of zeros will be carried around if {\bf nIter0} $<$ {\bf tIter0}.
\\
$\bullet$ {\bf nsubtime} is the integer number of extra timesteps
 required by the tracer experiment. This will give a timestep
 of {\bf deltaTtracer}$/${\bf nsubtime} for the dependencies
 between tracers. The default is one.
\\
$\bullet$ File names - these are several filenames than can be read in
 for external fields needed in the tracer forcing - for instance
 wind speed is needed in both DIC and CFC packages to calculate
 the air-sea exchange of gases. Not all file names will be used 
 for every tracer experiment. 

\vspace{.5cm}

\noindent
{{\bf INITIALIZATION}}\\
The values set at runtime in data.gchem are read in
using {\it gchem\_readparms.F} which is called from
packages\_readparms.F. This will include any external
forcing files that will be needed by the tracer experiment.

There are two routine used to initialize parameters and fields
needed by the experiment packages. These are
{\it gchem\_init\_fixed.F} which is called from packages\_init\_fixed.F, and
{\it gchem\_init\_vari.F} called from 
packages\_init\_variable.F. The first should
be used to call a subroutine specific to the tracer experiment
which sets fixed parameters, the second should call a subroutine
specific to the tracer experiment
which sets (or initializes) time fields that will vary with time.

\vspace{.5cm}


\noindent
{{\bf LOADING FIELDS}}\\
External forcing fields used by the tracer experiment are read
in by a subroutine (specific to the tracer experiment) called from
{\it gchem\_fields\_load.F}. This latter is called from forward\_step.F.

\vspace{.5cm}


\noindent
{{\bf FORCING}}\\
Tracer fields are advected-and-diffused by the ptracer package.
Additional changes (e.g. surface forcing or interactions
between tracers) to these fields are taken care of by the gchem
interface. For tracers that are essentially passive (e.g. CFC's)
but may have some surface boundary conditions
this can easily be done within the regular tracer timestep. In this case
{\it gchem\_forcing\_int.F} is called from ptracers\_integrate.F.
For tracers with more complicated dependencies on each other,
and especially tracers which require a smaller timestep than
deltaTtracer, it will be easier to use {\it gchem\_forcing\_sep.F}
which is called from forward\_step.F. There is a 
compiler option set in {\it GCHEM\_OPTIONS.h} that determines
which method is used: \#define PTRACERS\_SEPARATE\_FORCING
does the latter where tracers are forced separately from the
advection-diffusion code, and \#undef PTRACERS\_SEPARATE\_FORCING
includes the forcing in the regular timestepping.

\vspace{.5cm}

\noindent
{{\bf DIAGNOSTICS}}\\
This package also includes routines {\it gchem\_monitor.F} and 
{\it gchem\_mon\_print.F} which print out tracer statistics
as often as the model dynamic statistic diagnostics (dynsys) are written.
There is also a placeholder for any tracer experiment
specific diagnostics to be calculated and printed to files.
This is done in {\it gchem\_diags.F}. For instance the time average CO2
air-sea fluxes, and sea surface pH (among others) are written
out by dic\_biotic\_diags.F which is called from gchem\_diags.F.

\subsection{Do's and Don'ts}

The pkg ptracer is required with use with this pkg.
By itself, gchem pkg will read in {\bf data.gchem} and will
write out ptracer diagnostics. It requires tracer experiment
specific calls to do anything else (for instance the calls
to dic and cfc pkgs).

\subsection{Reference Material}

