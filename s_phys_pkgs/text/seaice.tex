% $Header: /u/gcmpack/manual/s_phys_pkgs/text/seaice.tex,v 1.7 2008/01/17 22:32:38 heimbach Exp $
% $Name:  $

%%EH3  Copied from "MITgcm/pkg/seaice/seaice_description.tex"
%%EH3  which was written by Dimitris M.


\subsection{SEAICE Package}
\label{sec:pkg:seaice}
\begin{rawhtml}
<!-- CMIREDIR:package_seaice: -->
\end{rawhtml}

Authors: Martin Losch, Dimitris Menemenlis, An Nguyen, Jean-Michel Campin,
Patrick Heimbach, Chris Hill and Jinlun Zhang

%----------------------------------------------------------------------
\subsubsection{Introduction
\label{sec:pkg:exf:intro}}


Package ``seaice'' provides a dynamic and thermodynamic interactive
sea-ice model. 

CPP options enable or disable different aspects of the package
(Section \ref{sec:pkg:seaice:config}).
Runtime options, flags, filenames and field-related dates/times are
set in \texttt{data.seaice}
(Section \ref{sec:pkg:seaice:runtime}).
A description of key subroutines is given in Section
\ref{sec:pkg:seaice:subroutines}.
Input fields, units and sign conventions are summarized in
Section \ref{sec:pkg:seaice:fields_units}, and available diagnostics
output is listed in Section \ref{sec:pkg:seaice:fields_diagnostics}.

%----------------------------------------------------------------------

\subsubsection{SEAICE configuration, compiling \& running}

\paragraph{Compile-time options
\label{sec:pkg:seaice:config}}
~

As with all MITgcm packages, SEAICE can be turned on or off at compile time
%
\begin{itemize}
%
\item
using the \texttt{packages.conf} file by adding \texttt{seaice} to it,
%
\item
or using \texttt{genmake2} adding
\texttt{-enable=seaice} or \texttt{-disable=seaice} switches
%
\item
\textit{required packages and CPP options}: \\
SEAICE requires the external forcing package \texttt{exf} to be enabled;
no additional CPP options are required.
%
\end{itemize}
(see Section \ref{sect:buildingCode}).

Parts of the SEAICE code can be enabled or disabled at compile time
via CPP preprocessor flags. These options are set in either
\texttt{SEAICE\_OPTIONS.h} or in \texttt{ECCO\_CPPOPTIONS.h}.
Table \ref{tab:pkg:seaice:cpp} summarizes these options.

\begin{table}[h!]
\centering
  \label{tab:pkg:seaice:cpp}
  {\footnotesize
    \begin{tabular}{|l|l|}
      \hline 
      \textbf{CPP option}  &  \textbf{Description}  \\
      \hline \hline
        \texttt{SEAICE\_DEBUG} & 
          Enhance STDOUT for debugging \\
        \texttt{SEAICE\_ALLOW\_DYNAMICS} & 
          sea-ice dynamics code \\
        \texttt{SEAICE\_CGRID} & 
          LSR solver on C-grid (rather than original B-grid \\
        \texttt{SEAICE\_ALLOW\_EVP} & 
          use EVP rather than LSR rheology solver \\
        \texttt{SEAICE\_EXTERNAL\_FLUXES} & 
          use EXF-computed fluxes as starting point \\
        \texttt{SEAICE\_MULTICATEGORY} & 
          enable 8-category thermodynamics \\
        \texttt{SEAICE\_VARIABLE\_FREEZING\_POINT} & 
          enable linear dependence of the freezing point on salinity \\
        \texttt{ALLOW\_SEAICE\_FLOODING} & 
          enable snow to ice conversion for submerged sea-ice \\
        \texttt{SEAICE\_SALINITY} & 
          enable "salty" sea-ice \\
        \texttt{SEAICE\_CAP\_HEFF} & 
          enable capping of sea-ice thickness to MAX\_HEFF \\
      \hline
    \end{tabular}
  }
  \caption{~}
\end{table}

%----------------------------------------------------------------------

\subsubsection{Run-time parameters
\label{sec:pkg:seaice:runtime}}

Run-time parameters are set in files 
\texttt{data.pkg} (read in \texttt{packages\_readparms.F}),
and \texttt{data.seaice} (read in \texttt{seaice\_readparms.F}).

\paragraph{Enabling the package}
~ \\
%
A package is switched on/off at runtime by setting
(e.g. for SEAICE) \texttt{useSEAICE = .TRUE.} in \texttt{data.pkg}.

\paragraph{General flags and parameters}
~ \\
%
\input{part6/seaice-parms.tex}



%----------------------------------------------------------------------
\subsubsection{Description
\label{sec:pkg:seaice:descr}}

[TO BE CONTINUED/MODIFIED]

Sea-ice model thermodynamics are based on Hibler
\cite{hib80}, that is, a 2-category model that simulates ice thickness
and concentration.  Snow is simulated as per Zhang et al.
\cite{zha98a}.  Although recent years have seen an increased use of
multi-category thickness distribution sea-ice models for climate
studies, the Hibler 2-category ice model is still the most widely used
model and has resulted in realistic simulation of sea-ice variability
on regional and global scales.  Being less complicated, compared to
multi-category models, the 2-category model permits easier application
of adjoint model optimization methods.

Note, however, that the Hibler 2-category model and its variants use a
so-called zero-layer thermodynamic model to estimate ice growth and
decay.  The zero-layer thermodynamic model assumes that ice does not
store heat and, therefore, tends to exaggerate the seasonal
variability in ice thickness.  This exaggeration can be significantly
reduced by using Semtner's \cite{sem76} three-layer thermodynamic
model that permits heat storage in ice.  Recently, the three-layer
thermodynamic model has been reformulated by Winton \cite{win00}.  The
reformulation improves model physics by representing the brine content
of the upper ice with a variable heat capacity.  It also improves
model numerics and consumes less computer time and memory.  The Winton
sea-ice thermodynamics have been ported to the MIT GCM; they currently
reside under pkg/thsice.  At present pkg/thsice is not fully
compatible with pkg/seaice and with pkg/exf.  But the eventual
objective is to have fully compatible and interchangeable
thermodynamic packages for sea-ice, so that it becomes possible to use
Hibler dynamics with Winton thermodyanmics.

The ice dynamics models that are most widely used for large-scale
climate studies are the viscous-plastic (VP) model \cite{hib79}, the
cavitating fluid (CF) model \cite{fla92}, and the
elastic-viscous-plastic (EVP) model \cite{hun97}.  Compared to the VP
model, the CF model does not allow ice shear in calculating ice
motion, stress, and deformation.  EVP models approximate VP by adding
an elastic term to the equations for easier adaptation to parallel
computers.  Because of its higher accuracy in plastic solution and
relatively simpler formulation, compared to the EVP model, we decided
to use the VP model as the dynamic component of our ice model.  To do
this we extended the alternating-direction-implicit (ADI) method of
Zhang and Rothrock \cite{zha00} for use in a parallel configuration.

The sea ice model requires the following input fields: 10-m winds, 2-m
air temperature and specific humidity, downward longwave and shortwave
radiations, precipitation, evaporation, and river and glacier runoff.
The sea ice model also requires surface temperature from the ocean
model and third level horizontal velocity which is used as a proxy for
surface geostrophic velocity.  Output fields are surface wind stress,
evaporation minus precipitation minus runoff, net surface heat flux,
and net shortwave flux.  The sea-ice model is global: in ice-free
regions bulk formulae are used to estimate oceanic forcing from the
atmospheric fields.


%----------------------------------------------------------------------

\subsubsection{Key subroutines
\label{sec:pkg:seaice:subroutines}}

Top-level routine: \texttt{exf\_getforcing.F}

{\footnotesize
\begin{verbatim}

C     !CALLING SEQUENCE:
c ...
c  seaice_model (TOP LEVEL ROUTINE)
c  |
c  |-- #ifdef SEAICE_CGRID
c  |     SEAICE_DYNSOLVER
c  |     |
c  |     |-- < compute proxy for geostrophic velocity >
c  |     |
c  |     |-- < set up mass per unit area and Coriolis terms >
c  |     |
c  |     |-- < dynamic masking of areas with no ice >
c  |     |
c  |     |

c  |   #ELSE
c  |     DYNSOLVER
c  |   #ENDIF
c  |
c  |-- if ( useOBCS ) 
c  |     OBCS_APPLY_UVICE
c  |
c  |-- if ( SEAICEadvHeff .OR. SEAICEadvArea .OR. SEAICEadvSnow .OR. SEAICEadvSalt )
c  |     SEAICE_ADVDIFF
c  |
c  |-- if ( usePW79thermodynamics ) 
c  |     SEAICE_GROWTH
c  |
c  |-- if ( useOBCS ) 
c  |     if ( SEAICEadvHeff ) OBCS_APPLY_HEFF
c  |     if ( SEAICEadvArea ) OBCS_APPLY_AREA
c  |     if ( SEAICEadvSALT ) OBCS_APPLY_HSALT
c  |     if ( SEAICEadvSNOW ) OBCS_APPLY_HSNOW
c  |
c  |-- < do various exchanges >
c  |
c  |-- < do additional diagnostics >
c  |
c  o

\end{verbatim}
}


%----------------------------------------------------------------------

\subsubsection{EXF diagnostics
\label{sec:pkg:seaice:diagnostics}}

Diagnostics output is available via the diagnostics package
(see Section \ref{sec:pkg:diagnostics}).
Available output fields are summarized in 
Table \ref{tab:pkg:seaice:diagnostics}.

\begin{table}[h!]
\centering
\label{tab:pkg:seaice:diagnostics}
{\footnotesize
\begin{verbatim}
---------+----+----+----------------+-----------------
 <-Name->|Levs|grid|<--  Units   -->|<- Tile (max=80c)
---------+----+----+----------------+-----------------
 SIarea  |  1 |SM  |m^2/m^2         |SEAICE fractional ice-covered area [0 to 1]
 SIheff  |  1 |SM  |m               |SEAICE effective ice thickness
 SIuice  |  1 |UU  |m/s             |SEAICE zonal ice velocity, >0 from West to East
 SIvice  |  1 |VV  |m/s             |SEAICE merid. ice velocity, >0 from South to North
 SIhsnow |  1 |SM  |m               |SEAICE snow thickness
 SIhsalt |  1 |SM  |g/m^2           |SEAICE effective salinity
 SIatmFW |  1 |SM  |m/s             |Net freshwater flux from the atmosphere (+=down)
 SIuwind |  1 |SM  |m/s             |SEAICE zonal 10-m wind speed, >0 increases uVel
 SIvwind |  1 |SM  |m/s             |SEAICE meridional 10-m wind speed, >0 increases uVel
 SIfu    |  1 |UU  |N/m^2           |SEAICE zonal surface wind stress, >0 increases uVel
 SIfv    |  1 |VV  |N/m^2           |SEAICE merid. surface wind stress, >0 increases vVel
 SIempmr |  1 |SM  |m/s             |SEAICE upward freshwater flux, > 0 increases salt
 SIqnet  |  1 |SM  |W/m^2           |SEAICE upward heatflux, turb+rad, >0 decreases theta
 SIqsw   |  1 |SM  |W/m^2           |SEAICE upward shortwave radiat., >0 decreases theta
 SIpress |  1 |SM  |m^2/s^2         |SEAICE strength (with upper and lower limit)
 SIzeta  |  1 |SM  |m^2/s           |SEAICE nonlinear bulk viscosity
 SIeta   |  1 |SM  |m^2/s           |SEAICE nonlinear shear viscosity
 SIsigI  |  1 |SM  |no units        |SEAICE normalized principle stress, component one
 SIsigII |  1 |SM  |no units        |SEAICE normalized principle stress, component two
 SIthdgrh|  1 |SM  |m/s             |SEAICE thermodynamic growth rate of effective ice thickness
 SIsnwice|  1 |SM  |m/s             |SEAICE ice formation rate due to flooding
 SIuheff |  1 |UU  |m^2/s           |Zonal Transport of effective ice thickness
 SIvheff |  1 |VV  |m^2/s           |Meridional Transport of effective ice thickness
 ADVxHEFF|  1 |UU  |m.m^2/s         |Zonal      Advective Flux of eff ice thickn
 ADVyHEFF|  1 |VV  |m.m^2/s         |Meridional Advective Flux of eff ice thickn
 DFxEHEFF|  1 |UU  |m.m^2/s         |Zonal      Diffusive Flux of eff ice thickn
 DFyEHEFF|  1 |VV  |m.m^2/s         |Meridional Diffusive Flux of eff ice thickn
 ADVxAREA|  1 |UU  |m^2/m^2.m^2/s   |Zonal      Advective Flux of fract area
 ADVyAREA|  1 |VV  |m^2/m^2.m^2/s   |Meridional Advective Flux of fract area
 DFxEAREA|  1 |UU  |m^2/m^2.m^2/s   |Zonal      Diffusive Flux of fract area
 DFyEAREA|  1 |VV  |m^2/m^2.m^2/s   |Meridional Diffusive Flux of fract area
 ADVxSNOW|  1 |UU  |m.m^2/s         |Zonal      Advective Flux of eff snow thickn
 ADVySNOW|  1 |VV  |m.m^2/s         |Meridional Advective Flux of eff snow thickn
 DFxESNOW|  1 |UU  |m.m^2/s         |Zonal      Diffusive Flux of eff snow thickn
 DFyESNOW|  1 |VV  |m.m^2/s         |Meridional Diffusive Flux of eff snow thickn
 ADVxSSLT|  1 |UU  |psu.m^2/s       |Zonal      Advective Flux of seaice salinity
 ADVySSLT|  1 |VV  |psu.m^2/s       |Meridional Advective Flux of seaice salinity
 DFxESSLT|  1 |UU  |psu.m^2/s       |Zonal      Diffusive Flux of seaice salinity
 DFyESSLT|  1 |VV  |psu.m^2/s       |Meridional Diffusive Flux of seaice salinity
\end{verbatim}
}
\caption{~}
\end{table}


%\subsubsection{Package Reference}

\subsubsection{Experiments and tutorials that use seaice}
\label{sec:pkg:seaice:experiments}

\begin{itemize}
\item{Labrador Sea experiment in lab\_sea verification directory. }
\end{itemize}

