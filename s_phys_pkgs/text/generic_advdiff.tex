% $Header: /u/gcmpack/manual/s_phys_pkgs/text/generic_advdiff.tex,v 1.6 2005/08/01 18:07:24 cnh Exp $
% $Name:  $


\subsection{Generic Advection/Diffusion}
\label{sec:pkg:gad}
\begin{rawhtml}
<!-- CMIREDIR:package_gad: -->
\end{rawhtml}

The {\tt generic\_advdiff} package contains high-level
subroutines to solve the advection-diffusion equation
of any tracer, either active (potential temperature,
salinity or water vapor) or passive (see pkg/ptracers).
(see also sections \ref{sect:tracer_equations} to
\ref{sect:tracer_advection_schemes}).


\subsubsection{Introduction}
Package ``generic\_advdiff'' provides a common set of routines for
calculating advective/diffusive fluxes for tracers (cell centered
quantities on a C-grid).

Many different advection schemes are available: the standard centered
second order, centered fourth order and upwind biased third order
schemes are known as linear methods and require some stable
time-stepping method such as Adams-Bashforth. Alternatives such as
flux-limited schemes are stable in the forward sense and are best
combined with the multi-dimensional method provided in gad\_advection.

\subsubsection{Key subroutines, parameters and files}
\label{sec:pkg:gad:implementation_synopsis}
There are two high-level routines:
\begin{itemize}
\item{GAD\_CALC\_RHS} calculates all fluxes at time level ``n'' and is
  used for the standard linear schemes. This must be used in
  conjuction with Adams--Bashforth time stepping. Diffusive and
  parameterized fluxes are always calculated here.

\item{GAD\_ADVECTION} calculates just the advective fluxes using the
  non-linear schemes and can not be used in conjuction with
  Adams--Bashforth time stepping.
\end{itemize}




