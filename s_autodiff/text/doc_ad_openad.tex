%**********************************************************************
\section{Adjoint code generation using OpenAD}
\label{sec_ad_openad}
\begin{rawhtml}
<!-- CMIREDIR:sec_ad_openad: -->
\end{rawhtml}
%**********************************************************************

Authors: Jean Utke, Patrick Heimbach and Chris Hill

\subsection{Introduction}

The development of OpenAD was initiated as part of the
ACTS (Adjoint Compiler Technology \& Standards) project funded  by the NSF Information Technology Research (ITR) program. 
The main goals for OpenAD initially defined for the  ACTS project are:
%
\begin{enumerate}
%
\item
develop a flexible, modular, open source tool that can ge`nerate adjoint codes of numerical simulation programs, 
%
\item
establish a platform for easy implementation and testing of source transformation algorithms via a language-independent abstract intermediate representation,
%
\item
support for source code written in C and Fortan,
%
\item
generate efficient tangent linear and adjoint for the 
MIT general circulation model.
%
\end{enumerate}

OpenAD's homepage is at \texttt{http://www-unix.mcs.anl.gov/OpenAD/}.
A development WIKI is at 
\texttt{http://wiki.mcs.anl.gov/OpenAD/index.php/Main\_Page}.
From the WIKI's main page, click on \texttt{Handling GCM} for
various aspects pertaining to differentiating the MITgcm with OpenAD.

\subsection{Downloading and installing OpenAD}

The OpenAD webpage has a detailed description on how to download and
build OpenAD. From its homepage, please click on 
\texttt{Download Test Binaries}.
You may either download pre-built binaries for quick trial,
or follow the detailed build process described at
\texttt{http://www-unix.mcs.anl.gov/OpenAD/access.html}

\subsection{Building MITgcm adjoint with OpenAD}

\textbf{17-January-2008} 

OpenAD was successfully built on head node of
\texttt{itrda.acesgrid.org}, for following system:

\begin{verbatim}
> uname -a
Linux itrda 2.6.22.2-42.fc6 #1 SMP Wed Aug 15 12:34:26 EDT 2007 i686 i686 i386 GNU/Linux

> cat /proc/version 
Linux version 2.6.22.2-42.fc6 (brewbuilder@hs20-bc2-4.build.redhat.com) 
(gcc version 4.1.2 20070626 (Red Hat 4.1.2-13)) #1 SMP Wed Aug 15 12:34:26 EDT 2007

> module load ifc/9.1.036 icc/9.1.042
\end{verbatim}

Head of MITgcm branch (checkpoint59m with some modif.s) was used for building
adjoint code.
Following routing needed special care (revert to revision 1.1):
\\
\texttt{MITgcm\_contrib/heimbach/OpenAD/OAD\_support/active\_module.f90 }


