% $Header: /u/gcmpack/manual/s_autodiff/text/doc_ad_the_model.tex,v 1.3 2001/11/15 15:05:45 cnh Exp $
% $Name:  $
\begin{figure}[b!]

{\scriptsize
\begin{verbatim}
   the_model_main
   |
   |--- initialise_fixed
   |
   |--- #ifdef ALLOW_ADJOINT_RUN
   |           |    
   |           |--- ctrl_unpack
   |           |    
   |           |--- adthe_main_loop
   |           |    |
   |           |    |--- initialise_varia
   |           |    |--- ctrl_map_forcing
   |           |    |--- do iloop = 1, nTimeSteps
   |           |    |       |--- forward_step
   |           |    |       |--- cost_tile
   |           |    |    end do
   |           |    |--- cost_final
   |           |    |
   |           |    |--- adcost_final
   |           |    |--- do iloop = nTimeSteps, 1, -1
   |           |    |       |--- adcost_tile
   |           |    |       |--- adforward_step
   |           |    |    end do
   |           |    |--- adctrl_map_forcing
   |           |    |--- adinitialise_varia
   |           |    o
   |           |
   |           |--- ctrl_pack
   |           |
   |--- #else
   |           |
   |           |--- the_main_loop
   |           |
   |    #endif
   |
   |--- #ifdef ALLOW_GRADIENT_CHECK
   |           |
   |           |--- grdchk_main
   |           o
   |    #endif
   o
\end{verbatim}
}
\caption{~}
\label{fig:adthemodel}
\end{figure}

