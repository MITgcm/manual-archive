{\scriptsize
\begin{verbatim}
  lsopt_top
      |
      |---- check arguments
      |---- CALL INSTORE
      |       |
      |       |---- determine whether OPWARMI available:
      |                * if no:  cold start: create OPWARMI
      |                * if yes: warm start: read from OPWARMI
      |             create or open OPWARMD
      |
      |---- check consistency between OPWARMI and model parameters
      | 
      |---- >>> if COLD start: <<<
      |      |  first simulation with f.g. xx_0; output: first ff_0, gg_0
      |      |  set first preconditioner value xdiff_0 to 1
      |      |  store xx(0), gg(0), xdiff(0) to OPWARMD (first 3 entries)
      |      |
      |     >>> else: WARM start: <<<
      |         read xx(i), gg(i) from OPWARMD (first 2 entries)
      |         for first warm start after cold start, i=0
      |
      |
      |
      |---- /// if ITMAX > 0: perform optimization (increment loop index i)
      |      (
      |      )---- save current values of gg(i-1) -> gold(i-1), ff -> fold(i-1)
      |      (---- CALL LSUPDXX
      |      )       |
      |      (       |---- >>> if jmax=0 <<<
      |      )       |      |  first optimization after cold start:
      |      (       |      |  preconditioner estimated via ff_0 - ff_(first guess)
      |      )       |      |  dd(i-1) = -gg(i-1)*preco
      |      (       |      |  
      |      )       |     >>> if jmax > 0 <<<
      |      (       |         dd(i-1) = -gg(i-1)
      |      )       |         CALL HESSUPD
      |      (       |           |
      |      )       |           |---- dd(i-1) modified via Hessian approx.
      |      (       |
      |      )       |---- >>> if <dd,gg> >= 0 <<<
      |      (       |         ifail = 4
      |      )       |
      |      (       |---- compute step size: tact(i-1)
      |      )       |---- compute update: xdiff(i) = xx(i-1) + tact(i-1)*dd(i-1)
      |      (
      |      )---- >>> if ifail = 4 <<<
      |      (         goto 1000
      |      )
      |      (---- CALL OPTLINE / LSLINE
      |      )       |
     ...    ...     ...
\end{verbatim}
}
